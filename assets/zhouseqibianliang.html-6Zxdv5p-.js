import{_ as s,c as a,a as t,o as e}from"./app-DyHmJYok.js";const l={};function p(o,n){return e(),a("div",null,[...n[0]||(n[0]=[t(`<h1 id="着色器变量" tabindex="-1"><a class="header-anchor" href="#着色器变量"><span>着色器变量</span></a></h1><p>顶点着色器和片元着色器是<strong>独立运行</strong>的，它们之间不能直接共享变量。为了让数据在不同阶段之间传递，WebGL 引入了三种特殊的变量类型：</p><ul><li><code>attribute</code>：从 JavaScript 传入顶点着色器的<strong>逐顶点数据</strong>。</li><li><code>uniform</code>：从 JavaScript 传入着色器的<strong>全局常量</strong>（对所有顶点/片元都一样）。</li><li><code>varying</code>：<strong>顶点着色器传给片元着色器</strong>的插值数据。</li></ul><h2 id="attribute" tabindex="-1"><a class="header-anchor" href="#attribute"><span>attribute</span></a></h2><p><code>attribute</code>只能在顶点着色器中使用，用于接收来自 JavaScript 的逐顶点数据。</p><h3 id="示例-传递顶点位置" tabindex="-1"><a class="header-anchor" href="#示例-传递顶点位置"><span>示例：传递顶点位置</span></a></h3><div class="language-glsl line-numbers-mode" data-highlighter="prismjs" data-ext="glsl" data-title="glsl"><pre class="language-glsl"><code><span class="line"><span class="token comment">// 顶点着色器</span></span>
<span class="line"><span class="token keyword">attribute</span> <span class="token keyword">vec3</span> aPosition<span class="token punctuation">;</span>  <span class="token comment">// 每个顶点的位置</span></span>
<span class="line"></span>
<span class="line"><span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">  gl_Position <span class="token operator">=</span> <span class="token keyword">vec4</span><span class="token punctuation">(</span>aPosition<span class="token punctuation">,</span> <span class="token number">1.0</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>在 JavaScript 中，你需要通过 <code>gl.getAttribLocation</code> 获取该 attribute 的位置，并用 <code>gl.vertexAttribPointer</code> 绑定缓冲区数据：</p><div class="language-javascript line-numbers-mode" data-highlighter="prismjs" data-ext="js" data-title="js"><pre class="language-javascript"><code><span class="line"><span class="token keyword">const</span> positionLoc <span class="token operator">=</span> gl<span class="token punctuation">.</span><span class="token function">getAttribLocation</span><span class="token punctuation">(</span>program<span class="token punctuation">,</span> <span class="token string">&#39;aPosition&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">gl<span class="token punctuation">.</span><span class="token function">enableVertexAttribArray</span><span class="token punctuation">(</span>positionLoc<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">gl<span class="token punctuation">.</span><span class="token function">vertexAttribPointer</span><span class="token punctuation">(</span>positionLoc<span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> gl<span class="token punctuation">.</span><span class="token constant">FLOAT</span><span class="token punctuation">,</span> <span class="token boolean">false</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><blockquote><p>✅ <strong>关键点</strong>：</p><ul><li><code>attribute</code> 是<strong>逐顶点</strong>的，每个顶点可以有不同的值。</li><li><strong>只能在顶点着色器中声明和使用</strong>。</li><li>必须通过缓冲区（Buffer）从 CPU 传入 GPU。</li></ul></blockquote><h2 id="uniform" tabindex="-1"><a class="header-anchor" href="#uniform"><span>uniform</span></a></h2><p><code>uniform</code> 是一种<strong>全局常量</strong>，可以在<strong>顶点着色器和片元着色器中同时使用</strong>。它的值在一次绘制调用（draw call）中<strong>对所有顶点和片元都相同</strong>。</p><h3 id="示例-传入一个颜色" tabindex="-1"><a class="header-anchor" href="#示例-传入一个颜色"><span>示例：传入一个颜色</span></a></h3><div class="language-glsl line-numbers-mode" data-highlighter="prismjs" data-ext="glsl" data-title="glsl"><pre class="language-glsl"><code><span class="line"><span class="token comment">// 片元着色器</span></span>
<span class="line"><span class="token keyword">uniform</span> <span class="token keyword">vec4</span> uColor<span class="token punctuation">;</span></span>
<span class="line"></span>
<span class="line"><span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">  gl_FragColor <span class="token operator">=</span> uColor<span class="token punctuation">;</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>JavaScript 中设置 uniform：</p><div class="language-javascript line-numbers-mode" data-highlighter="prismjs" data-ext="js" data-title="js"><pre class="language-javascript"><code><span class="line"><span class="token keyword">const</span> colorLoc <span class="token operator">=</span> gl<span class="token punctuation">.</span><span class="token function">getUniformLocation</span><span class="token punctuation">(</span>program<span class="token punctuation">,</span> <span class="token string">&#39;uColor&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">gl<span class="token punctuation">.</span><span class="token function">uniform4f</span><span class="token punctuation">(</span>colorLoc<span class="token punctuation">,</span> <span class="token number">1.0</span><span class="token punctuation">,</span> <span class="token number">0.0</span><span class="token punctuation">,</span> <span class="token number">0.0</span><span class="token punctuation">,</span> <span class="token number">1.0</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 红色</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><blockquote><p>✅ <strong>关键点</strong>：</p><ul><li><code>uniform</code> 在一次绘制中<strong>值不变</strong>。</li><li>可在<strong>顶点和片元着色器中共享</strong>。</li><li>通过 <code>gl.uniform*</code> 系列函数从 JavaScript 设置。</li></ul></blockquote><h2 id="varying" tabindex="-1"><a class="header-anchor" href="#varying"><span>varying</span></a></h2><p><code>varying</code> 是连接顶点着色器和片元着色器的桥梁。它用于将<strong>顶点着色器计算出的数据</strong>，<strong>插值后</strong>传递给片元着色器。</p><p>例如：你想让一个三角形从红渐变到蓝，就需要在顶点着色器中输出颜色，通过 <code>varying</code> 传给片元着色器，GPU 会自动在三角形内部进行<strong>线性插值</strong>。</p><h3 id="示例-顶点颜色插值" tabindex="-1"><a class="header-anchor" href="#示例-顶点颜色插值"><span>示例：顶点颜色插值</span></a></h3><div class="language-glsl line-numbers-mode" data-highlighter="prismjs" data-ext="glsl" data-title="glsl"><pre class="language-glsl"><code><span class="line"><span class="token comment">// 顶点着色器</span></span>
<span class="line"><span class="token keyword">attribute</span> <span class="token keyword">vec3</span> aColor<span class="token punctuation">;</span></span>
<span class="line"><span class="token keyword">varying</span> <span class="token keyword">vec3</span> vColor<span class="token punctuation">;</span>  <span class="token comment">// 声明 varying</span></span>
<span class="line"></span>
<span class="line"><span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">  vColor <span class="token operator">=</span> aColor<span class="token punctuation">;</span>      <span class="token comment">// 把顶点颜色传出去</span></span>
<span class="line">  gl_Position <span class="token operator">=</span> <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="language-glsl line-numbers-mode" data-highlighter="prismjs" data-ext="glsl" data-title="glsl"><pre class="language-glsl"><code><span class="line"><span class="token comment">// 片元着色器</span></span>
<span class="line"><span class="token keyword">varying</span> <span class="token keyword">vec3</span> vColor<span class="token punctuation">;</span>  <span class="token comment">// 接收插值后的颜色</span></span>
<span class="line"></span>
<span class="line"><span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">  gl_FragColor <span class="token operator">=</span> <span class="token keyword">vec4</span><span class="token punctuation">(</span>vColor<span class="token punctuation">,</span> <span class="token number">1.0</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><blockquote><p>✅ <strong>关键点</strong>：</p><ul><li><code>varying</code> 必须在<strong>两个着色器中同名声明</strong>。</li><li>GPU 会根据片元在图元中的位置，自动对 <code>varying</code> 值进行<strong>透视校正插值</strong>。</li><li>这是实现平滑着色、纹理映射等效果的基础。</li></ul></blockquote><h2 id="三者对比总结" tabindex="-1"><a class="header-anchor" href="#三者对比总结"><span>三者对比总结</span></a></h2><table><thead><tr><th>类型</th><th>作用域</th><th>数据特性</th><th>是否可变</th><th>典型用途</th></tr></thead><tbody><tr><td><code>attribute</code></td><td>仅顶点着色器</td><td>逐顶点</td><td>是</td><td>位置、颜色、法线</td></tr><tr><td><code>uniform</code></td><td>顶点 + 片元着色器</td><td>全局常量</td><td>否（单次绘制内）</td><td>矩阵、时间、光照参数</td></tr><tr><td><code>varying</code></td><td>顶点 → 片元（传递+插值）</td><td>插值后逐片元</td><td>是（由 GPU 插值）</td><td>颜色插值、纹理坐标</td></tr></tbody></table>`,26)])])}const c=s(l,[["render",p],["__file","zhouseqibianliang.html.vue"]]),r=JSON.parse('{"path":"/blogs/WebGL/2025/zhouseqibianliang.html","title":"着色器变量","lang":"en-US","frontmatter":{"title":"着色器变量","date":"2025-09-27T00:00:00.000Z","tags":["WebGL"],"categories":["WebGL"]},"headers":[{"level":2,"title":"attribute","slug":"attribute","link":"#attribute","children":[{"level":3,"title":"示例：传递顶点位置","slug":"示例-传递顶点位置","link":"#示例-传递顶点位置","children":[]}]},{"level":2,"title":"uniform","slug":"uniform","link":"#uniform","children":[{"level":3,"title":"示例：传入一个颜色","slug":"示例-传入一个颜色","link":"#示例-传入一个颜色","children":[]}]},{"level":2,"title":"varying","slug":"varying","link":"#varying","children":[{"level":3,"title":"示例：顶点颜色插值","slug":"示例-顶点颜色插值","link":"#示例-顶点颜色插值","children":[]}]},{"level":2,"title":"三者对比总结","slug":"三者对比总结","link":"#三者对比总结","children":[]}],"git":{"createdTime":1758968756000,"updatedTime":1758969157000,"contributors":[{"name":"Pcjmy","email":"1716045191@qq.com","commits":2}]},"filePathRelative":"blogs/WebGL/2025/着色器变量.md"}');export{c as comp,r as data};
