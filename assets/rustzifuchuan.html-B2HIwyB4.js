import{_ as n,c as a,a as t,o as e}from"./app-DyHmJYok.js";const p={};function l(o,s){return e(),a("div",null,[...s[0]||(s[0]=[t(`<p><strong>字符串（String）</strong> 是 Rust 中最重要的数据类型之一，用来处理文本数据。Rust 的字符串设计充分考虑了内存安全和性能，但也因此带来了一些复杂性。</p><h2 id="🌱-字符串类型概述" tabindex="-1"><a class="header-anchor" href="#🌱-字符串类型概述"><span>🌱 字符串类型概述</span></a></h2><p>Rust 有两种主要的字符串类型：</p><ul><li><strong><code>str</code></strong>：字符串切片，通常以借用形式 <code>&amp;str</code> 出现，存储在程序的二进制文件中或栈上</li><li><strong><code>String</code></strong>：可增长、可变、拥有所有权的 UTF-8 编码字符串类型，存储在堆上</li></ul><div class="language-rust line-numbers-mode" data-highlighter="prismjs" data-ext="rs" data-title="rs"><pre class="language-rust"><code><span class="line"><span class="token comment">// 字符串字面量 - 保存在程序二进制文件中，类型是 &amp;str</span></span>
<span class="line"><span class="token keyword">let</span> s1<span class="token punctuation">:</span> <span class="token operator">&amp;</span><span class="token keyword">str</span> <span class="token operator">=</span> <span class="token string">&quot;Hello&quot;</span><span class="token punctuation">;</span></span>
<span class="line"></span>
<span class="line"><span class="token comment">// String 类型 - 堆分配的可变字符串</span></span>
<span class="line"><span class="token keyword">let</span> <span class="token keyword">mut</span> s2<span class="token punctuation">:</span> <span class="token class-name">String</span> <span class="token operator">=</span> <span class="token class-name">String</span><span class="token punctuation">::</span><span class="token function">from</span><span class="token punctuation">(</span><span class="token string">&quot;Hello&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="🛠️-创建字符串" tabindex="-1"><a class="header-anchor" href="#🛠️-创建字符串"><span>🛠️ 创建字符串</span></a></h2><p>Rust 提供多种方式创建字符串：</p><ul><li><p><strong>使用 <code>String::new()</code> 创建空字符串</strong></p><div class="language-rust line-numbers-mode" data-highlighter="prismjs" data-ext="rs" data-title="rs"><pre class="language-rust"><code><span class="line"><span class="token keyword">let</span> <span class="token keyword">mut</span> s <span class="token operator">=</span> <span class="token class-name">String</span><span class="token punctuation">::</span><span class="token function">new</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div></li><li><p><strong>使用 <code>to_string()</code> 方法</strong></p><div class="language-rust line-numbers-mode" data-highlighter="prismjs" data-ext="rs" data-title="rs"><pre class="language-rust"><code><span class="line"><span class="token keyword">let</span> data <span class="token operator">=</span> <span class="token string">&quot;initial contents&quot;</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token keyword">let</span> s <span class="token operator">=</span> data<span class="token punctuation">.</span><span class="token function">to_string</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"></span>
<span class="line"><span class="token comment">// 直接对字符串字面量使用</span></span>
<span class="line"><span class="token keyword">let</span> s <span class="token operator">=</span> <span class="token string">&quot;initial contents&quot;</span><span class="token punctuation">.</span><span class="token function">to_string</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li><li><p><strong>使用 <code>String::from()</code> 函数</strong></p><div class="language-rust line-numbers-mode" data-highlighter="prismjs" data-ext="rs" data-title="rs"><pre class="language-rust"><code><span class="line"><span class="token keyword">let</span> s <span class="token operator">=</span> <span class="token class-name">String</span><span class="token punctuation">::</span><span class="token function">from</span><span class="token punctuation">(</span><span class="token string">&quot;initial contents&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div></li></ul><p>因为字符串使用 UTF-8 编码，所以可以包含任何有效的 UTF-8 数据：</p><div class="language-rust line-numbers-mode" data-highlighter="prismjs" data-ext="rs" data-title="rs"><pre class="language-rust"><code><span class="line"><span class="token keyword">let</span> hello <span class="token operator">=</span> <span class="token class-name">String</span><span class="token punctuation">::</span><span class="token function">from</span><span class="token punctuation">(</span><span class="token string">&quot;你好&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token keyword">let</span> hello <span class="token operator">=</span> <span class="token class-name">String</span><span class="token punctuation">::</span><span class="token function">from</span><span class="token punctuation">(</span><span class="token string">&quot;こんにちは&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token keyword">let</span> hello <span class="token operator">=</span> <span class="token class-name">String</span><span class="token punctuation">::</span><span class="token function">from</span><span class="token punctuation">(</span><span class="token string">&quot;Hello&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="📝-更新字符串" tabindex="-1"><a class="header-anchor" href="#📝-更新字符串"><span>📝 更新字符串</span></a></h2><p>String 类型支持动态增长，提供了多种方法来更新内容：</p><ul><li><p><strong>使用 <code>push_str()</code> 和 <code>push()</code> 添加内容</strong></p><div class="language-rust line-numbers-mode" data-highlighter="prismjs" data-ext="rs" data-title="rs"><pre class="language-rust"><code><span class="line"><span class="token keyword">let</span> <span class="token keyword">mut</span> s <span class="token operator">=</span> <span class="token class-name">String</span><span class="token punctuation">::</span><span class="token function">from</span><span class="token punctuation">(</span><span class="token string">&quot;foo&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">s<span class="token punctuation">.</span><span class="token function">push_str</span><span class="token punctuation">(</span><span class="token string">&quot;bar&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 添加字符串切片</span></span>
<span class="line"></span>
<span class="line"><span class="token keyword">let</span> <span class="token keyword">mut</span> s <span class="token operator">=</span> <span class="token class-name">String</span><span class="token punctuation">::</span><span class="token function">from</span><span class="token punctuation">(</span><span class="token string">&quot;lo&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line">s<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token char">&#39;l&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 添加单个字符</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li><li><p><strong>使用 <code>+</code> 操作符连接字符串</strong></p><div class="language-rust line-numbers-mode" data-highlighter="prismjs" data-ext="rs" data-title="rs"><pre class="language-rust"><code><span class="line"><span class="token keyword">let</span> s1 <span class="token operator">=</span> <span class="token class-name">String</span><span class="token punctuation">::</span><span class="token function">from</span><span class="token punctuation">(</span><span class="token string">&quot;Hello, &quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token keyword">let</span> s2 <span class="token operator">=</span> <span class="token class-name">String</span><span class="token punctuation">::</span><span class="token function">from</span><span class="token punctuation">(</span><span class="token string">&quot;world!&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token keyword">let</span> s3 <span class="token operator">=</span> s1 <span class="token operator">+</span> <span class="token operator">&amp;</span>s2<span class="token punctuation">;</span> <span class="token comment">// 注意：s1 被移动，之后不能使用</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><blockquote><p>⚠️ 注意：<code>+</code> 操作符使用 <code>add</code> 方法，其签名类似于 <code>fn add(self, s: &amp;str) -&gt; String</code>，所以第一个操作数会被移动。</p></blockquote></li><li><p><strong>使用 <code>format!</code> 宏（推荐方式）</strong></p><div class="language-rust line-numbers-mode" data-highlighter="prismjs" data-ext="rs" data-title="rs"><pre class="language-rust"><code><span class="line"><span class="token keyword">let</span> s1 <span class="token operator">=</span> <span class="token class-name">String</span><span class="token punctuation">::</span><span class="token function">from</span><span class="token punctuation">(</span><span class="token string">&quot;tic&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token keyword">let</span> s2 <span class="token operator">=</span> <span class="token class-name">String</span><span class="token punctuation">::</span><span class="token function">from</span><span class="token punctuation">(</span><span class="token string">&quot;tac&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token keyword">let</span> s3 <span class="token operator">=</span> <span class="token class-name">String</span><span class="token punctuation">::</span><span class="token function">from</span><span class="token punctuation">(</span><span class="token string">&quot;toe&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"></span>
<span class="line"><span class="token keyword">let</span> s <span class="token operator">=</span> <span class="token macro property">format!</span><span class="token punctuation">(</span><span class="token string">&quot;{s1}-{s2}-{s3}&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token comment">// 结果: &quot;tic-tac-toe&quot;</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><code>format!</code> 宏不会获取任何参数的所有权，使用起来更安全。</p></li></ul><h2 id="🚫-字符串索引的限制" tabindex="-1"><a class="header-anchor" href="#🚫-字符串索引的限制"><span>🚫 字符串索引的限制</span></a></h2><p>在 Rust 中，你不能直接使用索引语法访问字符串中的字符：</p><div class="language-rust line-numbers-mode" data-highlighter="prismjs" data-ext="rs" data-title="rs"><pre class="language-rust"><code><span class="line"><span class="token keyword">let</span> s <span class="token operator">=</span> <span class="token class-name">String</span><span class="token punctuation">::</span><span class="token function">from</span><span class="token punctuation">(</span><span class="token string">&quot;hello&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token comment">// let h = s[0]; // ❌ 编译错误！</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>为什么 Rust 不支持字符串索引？</strong></p><ol><li><strong>UTF-8 编码复杂性</strong>：不同字符占用的字节数不同，简单索引可能导致无效字符边界</li><li><strong>性能考虑</strong>：字符串索引操作应该在常量时间内完成，但 Rust 需要检查有效字符边界</li></ol><div class="language-rust line-numbers-mode" data-highlighter="prismjs" data-ext="rs" data-title="rs"><pre class="language-rust"><code><span class="line"><span class="token keyword">let</span> hello <span class="token operator">=</span> <span class="token class-name">String</span><span class="token punctuation">::</span><span class="token function">from</span><span class="token punctuation">(</span><span class="token string">&quot;Здравствуйте&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token comment">// 长度是 24 字节（每个西里尔字母占 2 字节），但只有 12 个字符</span></span>
<span class="line"><span class="token comment">// 直接索引第 1 字节可能返回不完整的字符数据</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="🔍-遍历字符串的方法" tabindex="-1"><a class="header-anchor" href="#🔍-遍历字符串的方法"><span>🔍 遍历字符串的方法</span></a></h2><p>当需要处理字符串内容时，Rust 提供了明确的迭代方法：</p><ul><li><p><strong>获取字符：使用 <code>chars()</code> 方法</strong></p><div class="language-rust line-numbers-mode" data-highlighter="prismjs" data-ext="rs" data-title="rs"><pre class="language-rust"><code><span class="line"><span class="token keyword">for</span> c <span class="token keyword">in</span> <span class="token string">&quot;Зд&quot;</span><span class="token punctuation">.</span><span class="token function">chars</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">    <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">&quot;{}&quot;</span><span class="token punctuation">,</span> c<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"><span class="token comment">// 输出:</span></span>
<span class="line"><span class="token comment">// З</span></span>
<span class="line"><span class="token comment">// д</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li><li><p><strong>获取字节：使用 <code>bytes()</code> 方法</strong></p><div class="language-rust line-numbers-mode" data-highlighter="prismjs" data-ext="rs" data-title="rs"><pre class="language-rust"><code><span class="line"><span class="token keyword">for</span> b <span class="token keyword">in</span> <span class="token string">&quot;Зд&quot;</span><span class="token punctuation">.</span><span class="token function">bytes</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">    <span class="token macro property">println!</span><span class="token punctuation">(</span><span class="token string">&quot;{}&quot;</span><span class="token punctuation">,</span> b<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"><span class="token comment">// 输出 4 个字节: 208, 151, 208, 180</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li><li><p><strong>获取图簇（Grapheme Clusters）</strong>：标准库未提供，可通过 crate 实现</p></li></ul><h2 id="🧩-字符串切片-谨慎使用" tabindex="-1"><a class="header-anchor" href="#🧩-字符串切片-谨慎使用"><span>🧩 字符串切片（谨慎使用）</span></a></h2><p>可以使用范围语法创建字符串切片，但需要小心确保切片边界位于有效的 UTF-8 字符边界：</p><div class="language-rust line-numbers-mode" data-highlighter="prismjs" data-ext="rs" data-title="rs"><pre class="language-rust"><code><span class="line"><span class="token keyword">let</span> hello <span class="token operator">=</span> <span class="token string">&quot;Здравствуйте&quot;</span><span class="token punctuation">;</span></span>
<span class="line"><span class="token keyword">let</span> s <span class="token operator">=</span> <span class="token operator">&amp;</span>hello<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">..</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token comment">// 获取前两个字符，因为每个字符占 2 字节</span></span>
<span class="line"><span class="token comment">// s 现在是 &quot;Зд&quot;</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><blockquote><p>⚠️ 尝试在无效的字符边界处切片会导致运行时 panic。</p></blockquote><h2 id="💡-核心要点总结" tabindex="-1"><a class="header-anchor" href="#💡-核心要点总结"><span>💡 核心要点总结</span></a></h2><ul><li><strong>UTF-8 编码</strong>：Rust 字符串始终使用 UTF-8 编码，支持国际化</li><li><strong>所有权模型</strong>：String 类型拥有数据的所有权，支持移动语义</li><li><strong>安全性优先</strong>：禁止直接索引防止无效内存访问</li><li><strong>明确操作</strong>：通过 <code>chars()</code>、<code>bytes()</code> 等方法明确指定操作单位</li></ul><p>Rust 的字符串设计虽然比其他语言复杂，但这种复杂性换来了内存安全和性能保证，避免了其他语言中常见的字符串处理错误。</p>`,29)])])}const i=n(p,[["render",l],["__file","rustzifuchuan.html.vue"]]),r=JSON.parse('{"path":"/blogs/rust/2025/rustzifuchuan.html","title":"rust 字符串","lang":"en-US","frontmatter":{"title":"rust 字符串","date":"2025-12-07T00:00:00.000Z","tags":["rust"],"categories":["rust"]},"headers":[{"level":2,"title":"🌱 字符串类型概述","slug":"🌱-字符串类型概述","link":"#🌱-字符串类型概述","children":[]},{"level":2,"title":"🛠️ 创建字符串","slug":"🛠️-创建字符串","link":"#🛠️-创建字符串","children":[]},{"level":2,"title":"📝 更新字符串","slug":"📝-更新字符串","link":"#📝-更新字符串","children":[]},{"level":2,"title":"🚫 字符串索引的限制","slug":"🚫-字符串索引的限制","link":"#🚫-字符串索引的限制","children":[]},{"level":2,"title":"🔍 遍历字符串的方法","slug":"🔍-遍历字符串的方法","link":"#🔍-遍历字符串的方法","children":[]},{"level":2,"title":"🧩 字符串切片（谨慎使用）","slug":"🧩-字符串切片-谨慎使用","link":"#🧩-字符串切片-谨慎使用","children":[]},{"level":2,"title":"💡 核心要点总结","slug":"💡-核心要点总结","link":"#💡-核心要点总结","children":[]}],"git":{"createdTime":1765105905000,"updatedTime":1765105905000,"contributors":[{"name":"Pcjmy","email":"1716045191@qq.com","commits":1}]},"filePathRelative":"blogs/rust/2025/rust字符串.md"}');export{i as comp,r as data};
